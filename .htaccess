# Enable URL Rewriting
RewriteEngine On

# Remove .php extension from URLs
# If the request is not a directory
RewriteCond %{REQUEST_FILENAME} !-d
# If the request is not an existing file
RewriteCond %{REQUEST_FILENAME} !-f
# If adding .php to the request creates a valid file
RewriteCond %{REQUEST_FILENAME}.php -f
# Rewrite to the .php file
RewriteRule ^(.+)$ $1.php [L,QSA]

# Redirect requests with .php extension to clean URLs (optional - for SEO)
RewriteCond %{THE_REQUEST} \s/(.+?)\.php[\s?] [NC]
RewriteRule ^ /%1 [R=301,L,NE]

# Security Headers
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Block access to sensitive files
<FilesMatch "^\.|\.((sql|log|ini))$">
    Require all denied
</FilesMatch>

# Disable Directory Browsing
Options -Indexes
